# ToonDB Vector HNSW Benchmark Workload
# Tests vector insertion and nearest-neighbor search performance

[workload]
name = "vector_hnsw"
description = "Measures ToonDB HNSW vector index insert and search performance"
runner = "rust"
binary = "perf-run"

[params]
# Vector parameters
dimension = 128
# HNSW parameters
max_connections = 16      # M parameter
ef_construction = 100     # ef for index building
ef_search = 50           # ef for searching
# Search parameters
k = 10                   # Number of nearest neighbors
# Dataset sizes (can be overridden by dataset)
n_vectors = 10000
n_queries = 100
# Iterations
warmup_iterations = 1
timed_iterations = 5
# Batch insert
batch_insert = true
batch_size = 1000

[metrics]
collect = [
    "insert_throughput_vec_per_s",
    "search_latency_ms_avg",
    "search_latency_ms_p50",
    "search_latency_ms_p99",
    "search_qps",
    "recall_at_k",
    "peak_rss_mb",
    "index_size_mb"
]

[thresholds]
insert_throughput_vec_per_s = { threshold = 5.0, better = "higher" }
search_latency_ms_avg = { threshold = 5.0, better = "lower" }
search_latency_ms_p50 = { threshold = 5.0, better = "lower" }
search_latency_ms_p99 = { threshold = 10.0, better = "lower" }
search_qps = { threshold = 5.0, better = "higher" }
recall_at_k = { threshold = 2.0, better = "higher" }
peak_rss_mb = { threshold = 8.0, better = "lower" }
